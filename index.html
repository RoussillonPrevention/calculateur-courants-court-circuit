<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculateur de Courants de Court-Circuit</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 4px;
            background-color: #f9f9f9;
        }
        .help-icon {
            color: #3498db;
            cursor: help;
            margin-left: 5px;
        }
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        #ik3 { color: red; font-weight: bold; }
        #ik2 { color: green; font-weight: bold; }
        #ik1 { color: blue; font-weight: bold; }
        .export-buttons {
            margin-top: 20px;
        }
        .export-buttons button {
            margin-right: 10px;
            background-color: #3498db;
        }
        .export-buttons button:hover {
            background-color: #2980b9;
        }
        .error {
            border-color: red;
        }
        .error-message {
            color: red;
            font-size: 0.8em;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <h1>Calculateur de Courants de Court-Circuit</h1>
    
    <div class="form-group">
        <label for="power">Puissance du transformateur (kVA):</label>
        <input type="number" id="power" min="25" max="2500" value="400">
        <div class="error-message" id="power-error"></div>
    </div>
    
    <div class="form-group">
        <label for="voltage">Tension secondaire (V):</label>
        <input type="number" id="voltage" value="400">
        <div class="error-message" id="voltage-error"></div>
    </div>
    
    <div class="form-group">
        <label for="couplage">Couplage du transformateur:</label>
        <select id="couplage">
            <option value="Dyn11">Dyn11</option>
            <option value="Yyn0">Yyn0</option>
            <option value="Dzn0">Dzn0</option>
        </select>
    </div>
    
    <div class="form-group">
        <label for="ucc">Tension de court-circuit Ucc (%):</label>
        <input type="number" id="ucc" step="0.1" value="4">
        <div class="error-message" id="ucc-error"></div>
    </div>
    
    <div class="form-group">
        <label for="material">Matériau des enroulements:</label>
        <select id="material">
            <option value="cuivre">Cuivre</option>
            <option value="aluminium">Aluminium</option>
        </select>
    </div>
    
    <div class="form-group">
        <label for="length">Longueur de la canalisation (m):</label>
        <input type="number" id="length" step="0.1" value="50">
        <div class="error-message" id="length-error"></div>
    </div>
    
    <div class="form-group">
        <label for="installation">Mode de pose de la canalisation:</label>
        <select id="installation">
            <option value="aerien">Aérien</option>
            <option value="canalisation">En canalisation</option>
            <option value="enterre">En terre</option>
        </select>
    </div>
    
    <div class="form-group">
        <label for="phaseSection">Section des conducteurs de phase (mm²):</label>
        <select id="phaseSection">
            <option value="1.5">1.5 mm²</option>
            <option value="2.5">2.5 mm²</option>
            <option value="6">6 mm²</option>
            <option value="10">10 mm²</option>
            <option value="16">16 mm²</option>
            <option value="25">25 mm²</option>
            <option value="35">35 mm²</option>
            <option value="50">50 mm²</option>
            <option value="70">70 mm²</option>
            <option value="95">95 mm²</option>
            <option value="120">120 mm²</option>
            <option value="150">150 mm²</option>
            <option value="185">185 mm²</option>
            <option value="240">240 mm²</option>
            <option value="300">300 mm²</option>
            <option value="400">400 mm²</option>
            <option value="500">500 mm²</option>
            <option value="630">630 mm²</option>
        </select>
    </div>
    
    <div class="form-group">
        <label for="phaseCount">Nombre de conducteurs par phase:</label>
        <select id="phaseCount">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
        </select>
    </div>
    
    <div class="form-group">
        <label for="neutralSection">Section des conducteurs de neutre (mm²):</label>
        <select id="neutralSection">
            <option value="1.5">1.5 mm²</option>
            <option value="2.5">2.5 mm²</option>
            <option value="6">6 mm²</option>
            <option value="10">10 mm²</option>
            <option value="16">16 mm²</option>
            <option value="25">25 mm²</option>
            <option value="35">35 mm²</option>
            <option value="50">50 mm²</option>
            <option value="70">70 mm²</option>
            <option value="95">95 mm²</option>
            <option value="120">120 mm²</option>
            <option value="150">150 mm²</option>
            <option value="185">185 mm²</option>
            <option value="240">240 mm²</option>
            <option value="300">300 mm²</option>
            <option value="400">400 mm²</option>
            <option value="500">500 mm²</option>
            <option value="630">630 mm²</option>
        </select>
    </div>
    
    <div class="form-group">
        <label for="neutralCount">Nombre de conducteurs de neutre:</label>
        <select id="neutralCount">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
        </select>
    </div>
    
    <button id="calculate">Calculer</button>
    
    <div id="result" class="result" style="display: none;">
        <h2>Résultats</h2>
        <p>Courant de court-circuit triphasé (Ik3): <span id="ik3">0</span> kA</p>
        <p>Courant de court-circuit biphasé (Ik2): <span id="ik2">0</span> kA</p>
        <p>Courant de court-circuit monophasé (Ik1): <span id="ik1">0</span> kA</p>
        
        <div class="export-buttons">
            <button id="export-pdf">Exporter en PDF</button>
            <button id="export-excel">Exporter en Excel</button>
        </div>
    </div>
    
    <div class="help-section">
        <h2>Aide et Explications</h2>
        <p><strong>Puissance du transformateur (kVA):</strong> Puissance apparente nominale du transformateur (de 25 à 2500 kVA).</p>
        <p><strong>Tension secondaire (V):</strong> Tension entre phases au secondaire du transformateur (typiquement 400V pour un réseau basse tension).</p>
        <p><strong>Couplage du transformateur:</strong> Configuration des enroulements (Dyn11, Yyn0, Dzn0).</p>
        <p><strong>Ucc (%):</strong> Tension de court-circuit exprimée en pourcentage de la tension nominale.</p>
        <p><strong>Matériau des enroulements:</strong> Cuivre ou aluminium, influence la résistance des enroulements.</p>
        <p><strong>Longueur de canalisation:</strong> Distance entre le transformateur et le point de court-circuit.</p>
        <p><strong>Mode de pose:</strong> Influence la résistance thermique et donc l'échauffement des câbles.</p>
        <p><strong>Section des conducteurs:</strong> Section des câbles de phase et de neutre.</p>
    </div>

    <script>
        document.getElementById('calculate').addEventListener('click', calculateICC);
        document.getElementById('export-pdf').addEventListener('click', exportToPDF);
        document.getElementById('export-excel').addEventListener('click', exportToExcel);
        
        // Validation des champs numériques
        document.getElementById('power').addEventListener('input', validateNumeric);
        document.getElementById('voltage').addEventListener('input', validateNumeric);
        document.getElementById('ucc').addEventListener('input', validateNumeric);
        document.getElementById('length').addEventListener('input', validateNumeric);
        
        function validateNumeric(e) {
            const input = e.target;
            const errorElement = document.getElementById(input.id + '-error');
            
            if (isNaN(input.value) || input.value === '') {
                input.classList.add('error');
                errorElement.textContent = 'Veuillez entrer un nombre valide';
                return false;
            } else {
                input.classList.remove('error');
                errorElement.textContent = '';
                return true;
            }
        }
        
        function calculateICC() {
            // Validation
            if (!validateNumeric({target: document.getElementById('power')}) ||
                !validateNumeric({target: document.getElementById('voltage')}) ||
                !validateNumeric({target: document.getElementById('ucc')}) ||
                !validateNumeric({target: document.getElementById('length')})) {
                return;
            }
            
            // Récupération des valeurs
            const Sn = parseFloat(document.getElementById('power').value); // kVA
            const U = parseFloat(document.getElementById('voltage').value); // V
            const Ucc = parseFloat(document.getElementById('ucc').value); // %
            const length = parseFloat(document.getElementById('length').value); // m
            const phaseSection = parseFloat(document.getElementById('phaseSection').value); // mm²
            const phaseCount = parseInt(document.getElementById('phaseCount').value);
            const material = document.getElementById('material').value;
            
            // Calcul de l'impédance du transformateur
            const Zt = (Ucc / 100) * (U * U) / (Sn * 1000); // Ohms
            
            // Calcul de la résistance des câbles (simplifié)
            let resistivity = material === 'cuivre' ? 0.018 : 0.028; // Ohm.mm²/m
            const Rcable = resistivity * length / (phaseSection * phaseCount);
            
            // Calcul de l'impédance totale (approximation)
            const Ztotal = Math.sqrt(Zt * Zt + Rcable * Rcable);
            
            // Calcul des courants de court-circuit
            const Ik3 = (U / Math.sqrt(3)) / Ztotal / 1000; // kA
            const Ik2 = Ik3 * Math.sqrt(3) / 2;
            const Ik1 = U / (Ztotal + Ztotal + Ztotal) / 1000; // Simplification
            
            // Affichage des résultats
            document.getElementById('ik3').textContent = Ik3.toFixed(2);
            document.getElementById('ik2').textContent = Ik2.toFixed(2);
            document.getElementById('ik1').textContent = Ik1.toFixed(2);
            
            document.getElementById('result').style.display = 'block';
        }
        
        function exportToPDF() {
            // Ici vous pourriez utiliser une librairie comme jsPDF
            alert('Fonctionnalité PDF à implémenter (avec jsPDF par exemple)');
        }
        
        function exportToExcel() {
            // Ici vous pourriez utiliser une librairie comme SheetJS
            alert('Fonctionnalité Excel à implémenter (avec SheetJS par exemple)');
        }
    </script>
</body>
</html>
