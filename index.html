<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calcul des courants de court-circuit</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            color: #333;
            max-width: 1200px;
            margin: auto;
        }
        h1, h2 {
            color: #2c3e50;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .section {
            flex: 1;
            min-width: 300px;
            background: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        label {
            display: block;
            margin-top: 10px;
            font-weight: bold;
        }
        select, input {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .orange {
            color: orange;
        }
        .red {
            color: red;
        }
        .blue {
            color: blue;
        }
        .yellow {
            color: #d4a017;
        }
        .green {
            color: green;
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            margin: 10px 0;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #2980b9;
        }
        .results {
            margin-top: 20px;
            padding: 15px;
            background: #e8f4f8;
            border-radius: 5px;
        }
        .help-section {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background: #f0f0f0;
            border-radius: 5px;
        }
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>
    <h1>Calcul des courants de court-circuit</h1>
    
    <button id="toggleHelp">Afficher/Masquer l'aide technique</button>
    
    <div class="help-section" id="helpSection">
        <h2>Aide technique</h2>
        <h3>Paramètres du transformateur</h3>
        <p><strong>Puissance (kVA)</strong>: Puissance apparente nominale du transformateur.</p>
        <p><strong>Tension secondaire</strong>: Tension nominale au secondaire du transformateur.</p>
        <p><strong>Couplage</strong>: Configuration des enroulements du transformateur (Dyn11, Yyn0, etc.).</p>
        <p><strong>Ucc (%)</strong>: Tension de court-circuit exprimée en pourcentage de la tension nominale.</p>
        
        <h3>Paramètres de la canalisation</h3>
        <p><strong>Âme</strong>: Matériau conducteur (cuivre ou aluminium).</p>
        <p><strong>Longueur</strong>: Longueur de la canalisation en mètres.</p>
        <p><strong>Mode de pose</strong>: Configuration des conducteurs (multi, monoconducteurs en trèfle, etc.).</p>
        <p><strong>Section des conducteurs</strong>: Section transversale des conducteurs de phase et de neutre.</p>
        <p><strong>Nombre de conducteurs</strong>: Nombre de conducteurs par phase et pour le neutre.</p>
        
        <h3>Résultats</h3>
        <p><strong>Ik3</strong>: Courant de court-circuit triphasé.</p>
        <p><strong>Ik2</strong>: Courant de court-circuit biphasé.</p>
        <p><strong>Ik1</strong>: Courant de court-circuit monophasé.</p>
    </div>
    
    <div class="container">
        <div class="section">
            <h2>Paramètres du transformateur</h2>
            
            <label for="power" class="orange">Puissance (kVA)</label>
            <select id="power">
                <option value="25">25 kVA</option>
                <option value="40">40 kVA</option>
                <option value="50">50 kVA</option>
                <option value="63">63 kVA</option>
                <option value="80">80 kVA</option>
                <option value="100" selected>100 kVA</option>
                <option value="125">125 kVA</option>
                <option value="160">160 kVA</option>
                <option value="200">200 kVA</option>
                <option value="250">250 kVA</option>
                <option value="315">315 kVA</option>
                <option value="400">400 kVA</option>
                <option value="500">500 kVA</option>
                <option value="630">630 kVA</option>
                <option value="800">800 kVA</option>
                <option value="1000">1000 kVA</option>
                <option value="1250">1250 kVA</option>
                <option value="1600">1600 kVA</option>
                <option value="2000">2000 kVA</option>
                <option value="2500">2500 kVA</option>
            </select>
            
            <label for="voltage">Tension secondaire</label>
            <select id="voltage">
                <option value="230">230 V</option>
                <option value="400" selected>400 V</option>
                <option value="690">690 V</option>
            </select>
            
            <label for="coupling">Couplage</label>
            <select id="coupling">
                <option value="Dyn11" selected>Dyn11</option>
                <option value="Yyn0">Yyn0</option>
                <option value="Dyn5">Dyn5</option>
                <option value="Yzn5">Yzn5</option>
                <option value="Dd0">Dd0</option>
                <option value="Yy0">Yy0</option>
            </select>
            
            <label for="ucc">Ucc (%) <span class="tooltip">?<span class="tooltiptext">Tension de court-circuit en pourcentage</span></span></label>
            <select id="ucc">
                <option value="4">4%</option>
                <option value="5">5%</option>
                <option value="6" selected>6%</option>
                <option value="7">7%</option>
                <option value="8">8%</option>
            </select>
        </div>
        
        <div class="section">
            <h2>Paramètres de la canalisation</h2>
            
            <label for="material">Âme</label>
            <select id="material">
                <option value="copper" selected>Cuivre</option>
                <option value="aluminum">Aluminium</option>
            </select>
            
            <label for="length">Longueur (mètres)</label>
            <input type="number" id="length" min="1" value="10">
            
            <label for="installation">Mode de pose</label>
            <select id="installation">
                <option value="multi">Multi</option>
                <option value="trefle" selected>Monoconducteurs en trèfle</option>
                <option value="jointifs">Monoconducteurs jointifs</option>
                <option value="espaces">Monoconducteurs espacés</option>
            </select>
            
            <label for="phaseSection" class="red">Section des conducteurs de phase (mm²)</label>
            <select id="phaseSection">
                <option value="1.5">1,5 mm²</option>
                <option value="2.5">2,5 mm²</option>
                <option value="4">4 mm²</option>
                <option value="6">6 mm²</option>
                <option value="10">10 mm²</option>
                <option value="16">16 mm²</option>
                <option value="25">25 mm²</option>
                <option value="35">35 mm²</option>
                <option value="50">50 mm²</option>
                <option value="70">70 mm²</option>
                <option value="95">95 mm²</option>
                <option value="120">120 mm²</option>
                <option value="150">150 mm²</option>
                <option value="185">185 mm²</option>
                <option value="240">240 mm²</option>
                <option value="300">300 mm²</option>
                <option value="400">400 mm²</option>
                <option value="500">500 mm²</option>
                <option value="630">630 mm²</option>
            </select>
            
            <label for="phaseCount" class="red">Nombre de conducteurs par phase</label>
            <select id="phaseCount">
                <option value="1" selected>1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
            </select>
            
            <label for="neutralSection" class="blue">Section des conducteurs de neutre (mm²)</label>
            <select id="neutralSection">
                <option value="1.5">1,5 mm²</option>
                <option value="2.5">2,5 mm²</option>
                <option value="4">4 mm²</option>
                <option value="6">6 mm²</option>
                <option value="10">10 mm²</option>
                <option value="16">16 mm²</option>
                <option value="25">25 mm²</option>
                <option value="35">35 mm²</option>
                <option value="50">50 mm²</option>
                <option value="70">70 mm²</option>
                <option value="95">95 mm²</option>
                <option value="120">120 mm²</option>
                <option value="150">150 mm²</option>
                <option value="185">185 mm²</option>
                <option value="240">240 mm²</option>
                <option value="300">300 mm²</option>
                <option value="400">400 mm²</option>
                <option value="500">500 mm²</option>
                <option value="630">630 mm²</option>
            </select>
            
            <label for="neutralCount" class="blue">Nombre de conducteurs de neutre</label>
            <select id="neutralCount">
                <option value="1" selected>1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
            </select>
        </div>
    </div>
    
    <button id="calculate">Calculer les courants de court-circuit</button>
    
    <div class="results" id="results">
        <h2>Résultats</h2>
        <p><span class="yellow">Courant de court-circuit à l'origine (Ik3 origine):</span> <span id="ikOrigin">-</span> kA</p>
        <p><span class="red">Courant de court-circuit triphasé (Ik3):</span> <span id="ik3">-</span> kA</p>
        <p><span class="green">Courant de court-circuit biphasé (Ik2):</span> <span id="ik2">-</span> kA</p>
        <p><span class="blue">Courant de court-circuit monophasé (Ik1):</span> <span id="ik1">-</span> kA</p>
    </div>
    
    <script>
        document.getElementById('toggleHelp').addEventListener('click', function() {
            const helpSection = document.getElementById('helpSection');
            if (helpSection.style.display === 'block') {
                helpSection.style.display = 'none';
            } else {
                helpSection.style.display = 'block';
            }
        });
        
        document.getElementById('calculate').addEventListener('click', calculateShortCircuit);
        
        function calculateShortCircuit() {
            // Récupération des paramètres du transformateur
            const power = parseFloat(document.getElementById('power').value);
            const voltage = parseFloat(document.getElementById('voltage').value);
            const coupling = document.getElementById('coupling').value;
            const ucc = parseFloat(document.getElementById('ucc').value) / 100;
            
            // Récupération des paramètres de la canalisation
            const material = document.getElementById('material').value;
            const length = parseFloat(document.getElementById('length').value);
            const installation = document.getElementById('installation').value;
            const phaseSection = parseFloat(document.getElementById('phaseSection').value);
            const phaseCount = parseInt(document.getElementById('phaseCount').value);
            const neutralSection = parseFloat(document.getElementById('neutralSection').value);
            const neutralCount = parseInt(document.getElementById('neutralCount').value);
            
            // Calcul de l'impédance du transformateur
            const zt = calculateTransformerImpedance(power, voltage, ucc);
            
            // Calcul de l'impédance des câbles
            const zc = calculateCableImpedance(material, length, phaseSection, phaseCount, neutralSection, neutralCount, installation, voltage);
            
            // Calcul des courants de court-circuit
            const ikOrigin = calculateIkOrigin(power, voltage, ucc);
            const ik3 = calculateIk3(zt, zc, voltage);
            const ik2 = calculateIk2(ik3);
            const ik1 = calculateIk1(zt, zc, voltage, coupling);
            
            // Affichage des résultats
            document.getElementById('ikOrigin').textContent = ikOrigin.toFixed(2);
            document.getElementById('ik3').textContent = ik3.toFixed(2);
            document.getElementById('ik2').textContent = ik2.toFixed(2);
            document.getElementById('ik1').textContent = ik1.toFixed(2);
        }
        
        function calculateTransformerImpedance(power, voltage, ucc) {
            // Calcul de l'impédance du transformateur
            const sn = power * 1000; // Conversion en VA
            const un = voltage;
            const zt = (ucc * Math.pow(un, 2)) / sn;
            return zt;
        }
        
        function calculateCableImpedance(material, length, phaseSection, phaseCount, neutralSection, neutralCount, installation, voltage) {
            // Résistivité des matériaux (Ω.mm²/m)
            const rhoCu = 0.0225; // Cuivre
            const rhoAl = 0.036;  // Aluminium
            
            // Réactance linéique selon le mode de pose (Ω/m)
            let x;
            switch(installation) {
                case 'multi':
                    x = 0.08 / 1000; // 0.08 mΩ/m
                    break;
                case 'trefle':
                    x = 0.10 / 1000;
                    break;
                case 'jointifs':
                    x = 0.12 / 1000;
                    break;
                case 'espaces':
                    x = 0.15 / 1000;
                    break;
                default:
                    x = 0.10 / 1000;
            }
            
            // Calcul de la résistance des conducteurs de phase
            const rho = material === 'copper' ? rhoCu : rhoAl;
            const rPhase = (rho * length) / (phaseSection * phaseCount);
            
            // Calcul de la résistance des conducteurs de neutre
            const rNeutral = (rho * length) / (neutralSection * neutralCount);
            
            // Calcul de la réactance
            const xTotal = x * length;
            
            // Calcul de l'impédance totale
            const zPhase = Math.sqrt(Math.pow(rPhase, 2) + Math.pow(xTotal, 2));
            const zNeutral = Math.sqrt(Math.pow(rNeutral, 2) + Math.pow(xTotal, 2));
            
            return {
                zPhase: zPhase,
                zNeutral: zNeutral,
                rPhase: rPhase,
                rNeutral: rNeutral,
                x: xTotal
            };
        }
        
        function calculateIkOrigin(power, voltage, ucc) {
            // Courant de court-circuit à l'origine (transformateur seul)
            const sn = power * 1000;
            const ik = sn / (Math.sqrt(3) * voltage * ucc);
            return ik / 1000; // Conversion en kA
        }
        
        function calculateIk3(zt, zc, voltage) {
            // Courant de court-circuit triphasé
            const zTotal = zt + zc.zPhase;
            const ik = voltage / (Math.sqrt(3) * zTotal);
            return ik / 1000; // Conversion en kA
        }
        
        function calculateIk2(ik3) {
            // Courant de court-circuit biphasé
            return ik3 * Math.sqrt(3) / 2;
        }
        
        function calculateIk1(zt, zc, voltage, coupling) {
            // Courant de court-circuit monophasé - version corrigée
            // Pour un court-circuit phase-neutre, la formule est :
            // Ik1 = Vph-n / (Z1 + Z2 + Z0)
            // Où Z1 = impédance directe (zt + zc.zPhase)
            // Z2 = impédance inverse (≈ Z1)
            // Z0 = impédance homopolaire (dépend du couplage du transformateur)
            
            // Impédance directe et inverse
            const z1 = zt + zc.zPhase;
            const z2 = z1; // On suppose Z2 ≈ Z1
            
            // Calcul de Z0 selon le couplage du transformateur
            let z0;
            if (coupling === 'Dyn11' || coupling === 'Yzn5') {
                // Pour les couplages avec neutre impédant (Dyn, Yzn)
                // Z0 ≈ Z1 pour simplifier (en réalité un peu plus élevé)
                z0 = z1 * 1.2; // Coefficient empirique
            } else if (coupling === 'Yyn0') {
                // Pour Yyn0, Z0 est plus élevée (circuit magnétique à colonnes)
                z0 = z1 * 3; // Coefficient empirique
            } else {
                // Pour les autres couplages sans neutre distribué
                z0 = Infinity; // Courant monophasé nul théoriquement
                return 0;
            }
            
            // Impédance totale pour le défaut phase-neutre
            const zTotal = z1 + z2 + z0 + 3 * zc.zNeutral;
            
            // Tension phase-neutre
            const vPhN = voltage / Math.sqrt(3);
            
            // Calcul du courant de court-circuit monophasé
            const ik1 = vPhN / zTotal;
            
            return ik1 / 1000; // Conversion en kA
        }
    </script>
</body>
</html>
